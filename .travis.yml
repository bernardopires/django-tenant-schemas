language: python
cache: pip

python:
  - 3.6
  - 3.7

matrix:
  include:
    - python: 2.7
      env: DJANGO=1.11
  fast_finish: true

services:
  - postgresql

addons:
  postgresql: "9.6"

install:
  - pip install -q tox-travis

before_script:
  - psql -c "CREATE DATABASE dpt_test_project;" -U postgres

script:
  - tox

env:
  - DJANGO=1.11
  - DJANGO=2.0
  - DJANGO=2.1
  - DJANGO=2.2
  - DJANGO=3.0

deploy:
  provider: pypi
  user: vintasoftware
  password:
    secure: "lXMVYTyPme6qVEjy1RHhDNlxZyfKAgEd4cbErqeH+t9lfdHLwvWumi1RwdxG+SJwdW3BXRVZCFNc1iNftdCFxBdZFQxEDKQDoPkJYES5j0yFXy+jVO5qa5D8GtCpERnp5cuz6WLvpms4BUKn6epTGChijS2g8gi1llAWwnQ6PdwRiBZ8ZlDT1mjpWm+vWTrom+JnHaQQsJmjPdfHcO7KnmsUXF+4SbKdvsJqJIIhVUf9qRb6vmuzkxNSU0htdogUMOd3DA/Cx0SsChqFgXHc+9HqP7UZnoOKT/1sOJIKnAGkMPFRulvIuOvgAa/WV4obcnEOQ7vnp8TDjWAo43AqpS1VcEea7lOtv2c69MQ9WvJl+Hn3yCtnzOsoyF8TJboGiaDGXFBV7WuomZD5INBy9L2ogyAiEETCylslnrl4lxZduncPYBhA3Ihab1vUWrdhXILHR6Sm4naCTC/Pixeu2/2ha76Jni91DBtVqEtW033PmBz+vL/AypEbbgJG0Vy6qiOrttNkH+VrbEywLNDzFuhhk/F5/DjEVoEpMnu7Yayu8F5d2H4JejgM7jK5P9KfkhX2DhVArZkEnnCmVor9Q+EoXGSql0cmm3hRfQk673qXK67bDTtKD0biJoetj+OjzoLU2KR7qY68M7S5AUHza3U6lfSV3COf2OH/TTx8xmk="
  on:
    distributions: sdist bdist_wheel
    repo: vintasoftware/django-pg-tenants
    tags: true
    skip_existing: true
